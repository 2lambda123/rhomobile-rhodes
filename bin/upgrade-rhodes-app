#!/usr/bin/env ruby
require 'rubygems'
require 'fileutils'
include FileUtils
puts File.dirname(__FILE__)

$app_config = YAML::load_file("build.yml")


unless $app_config["env"].nil? #if env is here then it is an old app
  new_config = Hash.new
  new_config["sdk"] = File.expand_path(File.dirname(__FILE__) + "/../")
  new_config["name"] = "Rhodes"
  new_config["version"] = $app_config["env"]["version"]
  new_config["vendor"] = $app_config["env"]["vendor"]
  new_config["bbver"] = $app_config["env"]["bbver"]
  new_config["applog"] = $app_config["env"]["applog"]

  $app_config = new_config
  File.open(  'build.yml', 'w' ) do |out|
    YAML.dump( $app_config, out )
  end
end

cp File.dirname(__FILE__) + '/../res/generators/templates/application/Rakefile', 'Rakefile'
